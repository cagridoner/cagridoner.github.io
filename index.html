<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Queer Domesticity: Mirror Edition</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- tailwind.config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    colors: {
                        'mirror-dark': '#050505',
                        'silver-plate': '#E8E8E8',
                        'lipstick-red': '#D90429',
                        'deep-red': '#600110',
                    },
                    animation: {
                        'pulse-red': 'pulseRed 2s infinite',
                    },
                    keyframes: {
                        pulseRed: {
                            '0%, 100%': { boxShadow: '0 0 0 0 rgba(217, 4, 41, 0.4)' },
                            '70%': { boxShadow: '0 0 0 10px rgba(217, 4, 41, 0)' },
                        }
                    }
                },
            },
        };
    </script>

    <!-- Leaflet.js -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        /* --- Ä°MLEÃ‡ AYARLARI --- */

        /* 1. GerÃ§ek mouse'u gizle */
        body,
        a,
        button,
        .location-card,
        .leaflet-interactive {
            cursor: none !important;
        }

        /* 2. Ã–zel Ä°mleÃ§ Div'i */
        #custom-cursor {
            position: fixed;
            top: 0;
            left: 0;
            width: 40px;
            height: 40px;
            z-index: 10000;
            pointer-events: none;
            background-image: url('https://files.catbox.moe/u70y1m.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            /* HALO EFEKTÄ° */
            filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.8)) drop-shadow(0 0 5px rgba(255, 255, 255, 0.5));
            transition: transform 0.05s linear;
            /* Daha hÄ±zlÄ± tepki sÃ¼resi */
            transform: translate(-50%, -50%);
        }

        /* TÄ±klama efekti */
        .clicking-cursor {
            transform: translate(-50%, -50%) scale(0.8) !important;
            filter: drop-shadow(0 0 10px #D90429) !important;
        }

        body.hovering #custom-cursor {
            transform: translate(-50%, -50%) scale(1.3);
            filter: drop-shadow(0 0 5px #D90429);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
            border: 1px solid #000;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #D90429;
        }

        /* --- STÄ°LLER --- */
        body {
            background-color: #050505;
            color: #E8E8E8;
            background-image: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #000000 100%);
            overflow-x: hidden;
        }

        /* Ayna Panelleri */
        .mirror-panel {
            background: linear-gradient(145deg, rgba(30, 30, 30, 0.9), rgba(10, 10, 10, 0.95));
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-top: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(12px);
        }

        /* Kart TasarÄ±mÄ± */
        .location-card {
            background: rgba(20, 20, 20, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .location-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 100%;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: skewX(-25deg);
            transition: 0.5s;
            z-index: 20;
            pointer-events: none;
        }

        .location-card:hover::before {
            left: 150%;
            transition: 0.7s;
        }

        .location-card:hover {
            border-color: #D90429;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(217, 4, 41, 0.15);
            background: rgba(30, 30, 30, 0.8);
        }

        .location-card img {
            filter: grayscale(100%) contrast(110%) brightness(80%);
            transition: all 0.5s ease;
        }

        .location-card:hover img {
            filter: grayscale(0%) contrast(100%) brightness(100%);
        }

        .card-highlighted {
            border: 1px solid #D90429 !important;
            box-shadow: 0 0 30px rgba(217, 4, 41, 0.4) !important;
            transform: scale(1.02);
            z-index: 50;
        }

        /* Harita */
        #map-diagram {
            height: 550px;
            width: 100%;
            background-color: #111;
            border: 1px solid rgba(255, 255, 255, 0.2);
            filter: grayscale(100%) contrast(110%) brightness(70%);
            transition: all 0.5s ease;
        }

        #map-diagram:hover {
            filter: grayscale(60%) contrast(100%) brightness(85%);
        }

        .marker-highlighted div {
            background-color: #D90429 !important;
            color: white !important;
            transform: scale(1.3);
            box-shadow: 0 0 20px #D90429 !important;
            border-color: white !important;
            z-index: 999;
        }
    </style>

    <!-- Sound Effect -->
    <audio id="Sound" preload="auto">
        <source src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3" type="audio/mp3">
    </audio>

</head>

<body class="min-h-screen pb-24 selection:bg-lipstick-red selection:text-white">

    <!-- Ã–ZEL Ä°MLEÃ‡ DÄ°V'Ä° -->
    <div id="custom-cursor"></div>

    <!-- Ä°Ã‡ERÄ°K -->
    <div class="max-w-7xl mx-auto space-y-12 pt-12 px-6">
        <header class="text-center py-8 relative">
            <div
                class="absolute top-0 left-1/2 -translate-x-1/2 w-px h-20 bg-gradient-to-b from-transparent via-lipstick-red to-transparent opacity-50">
            </div>
            <h1
                class="text-6xl md:text-8xl font-serif mb-4 text-transparent bg-clip-text bg-gradient-to-b from-white to-gray-500 drop-shadow-2xl">
                Queer London</h1>
            <h2 class="text-3xl md:text-4xl font-serif italic text-gray-400 mb-6">& The Politics of <span
                    class="text-lipstick-red underline decoration-1 underline-offset-4">Erasure</span></h2>
            <p
                class="text-silver-plate text-xs md:text-sm tracking-[0.3em] font-bold uppercase border-t border-b border-white/10 py-4 inline-block">
                Domesticity â€¢ Resistance â€¢ Archive</p>
        </header>

        <section id="map-section" class="mirror-panel p-2 rounded-sm relative">
            <div id="map-diagram" class="rounded-sm z-0"></div>
            <!-- Lejand -->
            <div id="legend" class="absolute top-4 right-4 z-[1000] leaflet-control hidden md:block">
                <div class="bg-black/90 border border-white/20 p-4 rounded-sm w-56 backdrop-blur-md shadow-2xl">
                    <p class="font-serif text-lipstick-red mb-3 text-lg border-b border-white/10 pb-2 italic">Legend</p>
                    <div class="mb-4">
                        <p class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2">DÃ¶nemler</p>
                        <div class="space-y-1.5">
                            <div class="flex items-center gap-2 text-xs text-gray-300"><span
                                    class="w-2 h-2 rounded-full bg-[#333] border border-white/50"></span> 1700s</div>
                            <div class="flex items-center gap-2 text-xs text-gray-300"><span
                                    class="w-2 h-2 rounded-full bg-[#555] border border-white/50"></span> Early 20th
                            </div>
                            <div class="flex items-center gap-2 text-xs text-gray-300"><span
                                    class="w-2 h-2 rounded-full bg-[#777] border border-white/50"></span> Mid-Century
                            </div>
                            <div class="flex items-center gap-2 text-xs text-gray-300"><span
                                    class="w-2 h-2 rounded-full bg-[#AAA] border border-white/50"></span> Late 20th
                            </div>
                            <div class="flex items-center gap-2 text-xs text-white font-bold"><span
                                    class="w-2 h-2 rounded-full bg-[#FFF] border border-white"></span> 21st Century
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="locations-section" class="pb-20">
            <h3 class="text-3xl font-serif text-white mb-10 text-center"><span
                    class="border-b border-lipstick-red pb-2 italic">The Archive</span></h3>
            <div id="location-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. Ã–ZEL Ä°MLEÃ‡ MANTIÄžI ---
            const cursor = document.getElementById('custom-cursor');

            document.addEventListener('mousemove', (e) => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';
            });

            document.addEventListener('mousedown', () => {
                cursor.classList.add('clicking-cursor');
            });
            document.addEventListener('mouseup', () => {
                cursor.classList.remove('clicking-cursor');
            });

            // Hover Efekti
            document.body.addEventListener('mouseover', (e) => {
                if (e.target.closest('a') || e.target.closest('button') || e.target.closest('.location-card') || e.target.closest('.leaflet-interactive')) {
                    document.body.classList.add('hovering');
                } else {
                    document.body.classList.remove('hovering');
                }
            });

            // --- 2. GELÄ°ÅžMÄ°Åž TIKLAMA SESÄ° (Audio Pool) ---
            // Ses dosyasÄ± URL'si
            const soundUrl = 'https://files.catbox.moe/id40qe.mp3';

            // Ã‡oklu ses kanalÄ± oluÅŸtur (hÄ±zlÄ± tÄ±klamalarda Ã¼st Ã¼ste binebilmesi iÃ§in)
            const audioPool = [];
            const poolSize = 5; // AynÄ± anda Ã§alabilecek maksimum ses sayÄ±sÄ±

            for (let i = 0; i < poolSize; i++) {
                const a = new Audio(soundUrl);
                a.volume = 0.4; // Ses seviyesi (%40)
                audioPool.push(a);
            }

            let poolIndex = 0;

            document.addEventListener('click', () => {
                const sound = audioPool[poolIndex];
                sound.currentTime = 0; // BaÅŸa sar
                sound.play().catch(e => console.log("Ses Ã§alÄ±namadÄ± (TarayÄ±cÄ± engeli olabilir)", e));

                // Bir sonraki kanala geÃ§
                poolIndex = (poolIndex + 1) % poolSize;
            });


            // --- 3. HARÄ°TA & VERÄ° ---
            const ERA_COLORS = { 'era-1700s': '#333', 'era-early-20th': '#555', 'era-mid-century': '#777', 'era-late-20th': '#AAA', 'era-21st-century': '#FFF' };
            const locations = [
                { id: 'molly', title: 'Molly-houses', era: '1700s', icon: 'âš¡ï¸', color: 'era-1700s', coords: [51.5174, -0.1100], addr: 'Holborn', desc: 'Underground taverns for socialization and cross-dressing.', img: 'https://media.londonmuseum.org.uk/images/A-Morning-Frolic-or-the-Transmut.width-1120.format-webp.webp' },
                { id: 'strawberry', title: 'Strawberry Hill', era: '1700s', icon: 'ðŸ ', color: 'era-1700s', coords: [51.4379, -0.3350], addr: 'Twickenham', desc: 'Gothic villa representing queer aestheticism.', img: 'https://daily.jstor.org/wp-content/uploads/2021/01/strawberry_hill_1050x700.jpg' },
                { id: 'moorfields', title: 'Moorfields', era: '1700s', icon: 'ðŸ›ï¸', color: 'era-1700s', coords: [51.5188, -0.0883], addr: 'Finsbury', desc: 'Notorious cruising ground.', img: 'https://i0.wp.com/biancawhitewrites.com/wp-content/uploads/2024/02/img_sodomites_shame_headpiece.png?resize=1024%2C693&ssl=1' },
                { id: 'fitzroy', title: '25 Fitzroy Sq', era: 'Early 20th', icon: 'ðŸ ', color: 'era-early-20th', coords: [51.5218, -0.1394], addr: 'Fitzrovia', desc: 'Bloomsbury Group hub.', img: 'https://www.thetimes.com/imageserver/image/%2Fmethode%2Fsundaytimes%2Fprod%2Fweb%2Fbin%2Fb6f23d6c-fb73-11e6-8121-0035d63ed063.jpg?crop=1500%2C1000%2C0%2C0' },
                { id: 'gateways', title: 'The Gateways', era: 'Mid-Century', icon: 'ðŸ¸', color: 'era-mid-century', coords: [51.4886, -0.1706], addr: 'Chelsea', desc: 'Legendary lesbian club behind a green door.', img: 'https://ichef.bbci.co.uk/news/976/cpsprodpb/1399/production/_103658979_gateways.jpg' },
                { id: 'rvt', title: 'Royal Vauxhall Tavern', era: 'Late 20th', icon: 'ðŸ¸', color: 'era-late-20th', coords: [51.4884, -0.1223], addr: 'Vauxhall', desc: 'Iconic performance venue and community hub.', img: 'https://static.standard.co.uk/s3fs-public/thumbnails/image/2015/09/08/12/RVT.jpg?width=1200' },
                { id: 'gays_word', title: "Gay's the Word", era: 'Late 20th', icon: 'ðŸ¢', color: 'era-late-20th', coords: [51.5244, -0.1259], addr: 'Bloomsbury', desc: 'UK\'s first dedicated LGBTQ+ bookshop.', img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Gay%27s_The_Word_shop_front.jpg/1200px-Gay%27s_The_Word_shop_front.jpg' },
                { id: 'tonic', title: 'Tonic@Bankhouse', era: '21st-Century', icon: 'ðŸ²', color: 'era-21st-century', coords: [51.4926, -0.1200], addr: 'Vauxhall', desc: 'LGBT+ affirmative retirement community.', img: 'https://images.squarespace-cdn.com/content/v1/5b603c6a36099b6781c03958/1632133582464-5L8L7G8Q4Q4Q4Q4Q4Q4Q/Tonic%40Bankhouse+Exterior.jpg' }
            ];

            // HARÄ°TA BAÅžLATMA
            let map, markers = {}, highlightedMarker = null, highlightedCard = null;
            const container = document.getElementById('location-container');

            try {
                map = L.map('map-diagram', { zoomControl: false }).setView([51.505, -0.14], 12);
                L.control.zoom({ position: 'bottomright' }).addTo(map);
                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { maxZoom: 19, attribution: '&copy; CARTO' }).addTo(map);

                locations.forEach(loc => {
                    // Kart
                    const card = document.createElement('div');
                    card.id = `card-${loc.id}`;
                    card.className = `location-card rounded-sm group`;
                    card.innerHTML = `<div class="w-full h-52 overflow-hidden relative border-b border-white/10"><img src="${loc.img}" class="w-full h-full object-cover" onerror="this.src='https://placehold.co/800x400/111/333?text=Hidden'"><div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent opacity-80"></div></div><div class="p-6 relative z-10"><div class="flex items-center justify-between mb-3"><span class="text-2xl drop-shadow-lg">${loc.icon}</span><span class="text-[10px] font-bold tracking-widest uppercase text-gray-400 border border-gray-600 px-2 py-1 rounded-full bg-black/50">${loc.era}</span></div><h4 class="text-xl font-serif text-white mb-1 group-hover:text-lipstick-red transition-colors italic">${loc.title}</h4><p class="text-xs text-gray-500 font-bold uppercase tracking-wider mb-3">${loc.addr}</p><p class="text-sm readable-text opacity-80 group-hover:opacity-100 transition-opacity">${loc.desc}</p></div>`;
                    card.addEventListener('click', () => navigateToDetailPage(loc.id));
                    container.appendChild(card);

                    // Marker
                    const icon = L.divIcon({ className: 'custom-div-icon', html: `<div style="background-color:${ERA_COLORS[loc.color]};" class="w-8 h-8 rounded-full flex items-center justify-center border-2 border-white/30 text-white shadow-lg transition-transform hover:scale-125"><span class="text-xs">${loc.icon}</span></div>`, iconSize: [32, 32], iconAnchor: [16, 16] });
                    const marker = L.marker(loc.coords, { icon: icon }).addTo(map);
                    marker.bindTooltip(loc.title, { permanent: false, direction: 'top', offset: [0, -20], className: 'bg-black text-white border border-white/20 px-2 py-1 rounded text-xs' });
                    marker.on('click', () => scrollToLocationCard(loc.id));
                    markers[loc.id] = marker;
                });
            } catch (e) { console.error(e); }

            function navigateToDetailPage(id) {
                const location = locations.find(l => l.id === id);
                if (!location) return;

                // Derive type from icon or use default
                const iconToType = {
                    'âš¡ï¸': 'Temporary Social Gathering',
                    'ðŸ ': 'Private/Domestic Residence',
                    'ðŸ¸': 'Commercial Club',
                    'ðŸ²': 'Shared & Co-operative Living',
                    'ðŸ¢': 'Commercial Club',
                    'ðŸ›ï¸': 'Historical Association'
                };
                const type = iconToType[location.icon] || 'Temporary Social Gathering';

                // Create URL parameters
                const params = new URLSearchParams({
                    id: location.id,
                    title: encodeURIComponent(location.title),
                    era: encodeURIComponent(location.era),
                    type: encodeURIComponent(type),
                    addr: encodeURIComponent(location.addr),
                    desc: encodeURIComponent(location.desc),
                    img: encodeURIComponent(location.img || ''),
                    coords: location.coords.join(',')
                });

                // Navigate to detail page
                window.location.href = `location-detail.html?${params.toString()}`;
            }

            function scrollToLocationCard(id) {
                const m = markers[id], c = document.getElementById(`card-${id}`), l = locations.find(x => x.id === id);
                if (!m || !c) return;
                if (highlightedMarker) highlightedMarker.classList.remove('marker-highlighted');
                if (highlightedCard) highlightedCard.classList.remove('card-highlighted');
                m.getElement().classList.add('marker-highlighted');
                c.classList.add('card-highlighted');
                highlightedMarker = m.getElement(); highlightedCard = c;
                map.flyTo(l.coords, 14, { animate: true, duration: 1.2 });
                c.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // sound effect
            const Sound = document.getElementById('Sound');

            // Play sound on any click
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.leaflet-container') &&
                    !e.target.closest('.leaflet-control-zoom') &&
                    !e.target.closest('a[href^="http"]')) {
                    Sound.currentTime = 0;
                    Sound.volume = 0.3; // Lower volume
                    Sound.play().catch(e => console.log('Sound play failed:', e));
                }
            });

            // Also play sound when hovering over interactive elements
            const interactiveElements = document.querySelectorAll('a, button, .location-card, .leaflet-interactive');
            interactiveElements.forEach(el => {
                el.addEventListener('mouseenter', () => {
                    Sound.currentTime = 0.5; // Start from middle of sound
                    Sound.volume = 0.2; // Even lower volume for hover
                    Sound.play().catch(e => { });
                });
            });
        });
    </script>

</body>

</html>
