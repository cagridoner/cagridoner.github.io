<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Location Details - Queer Domesticity and Erasure: London Spaces</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- tailwind.config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    colors: {
                        'noir-dark': '#050505',
                        'silver-plate': '#E8E8E8',
                        'lipstick-red': '#D90429',
                        'deep-red': '#600110',
                    },
                    animation: {
                        'pulse-red': 'pulseRed 2s infinite',
                    },
                    keyframes: {
                        pulseRed: {
                            '0%, 100%': { boxShadow: '0 0 0 0 rgba(217, 4, 41, 0.4)' },
                            '70%': { boxShadow: '0 0 0 10px rgba(217, 4, 41, 0)' },
                        }
                    }
                },
            },
        };
    </script>

    <!-- Leaflet.js CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <!-- Leaflet.js JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Custom Fonts (Using Helvetica Neue Light now) -->
    <style>
        @font-face {
            font-family: 'Helvetica Neue Light';
            src: local('Helvetica Neue Light'),
                local('HelveticaNeue-Light'),
                local('Helvetica Neue');
            font-weight: 300;
            font-style: normal;
        }
    </style>

    <style>
        /* --- ƒ∞MLE√á AYARLARI --- */

        /* 1. Ger√ßek mouse'u gizle */
        body,
        a,
        button,
        .location-card,
        .leaflet-interactive {
            cursor: none !important;
        }

        /* 2. √ñzel ƒ∞mle√ß Div'i */
        #custom-cursor {
            position: fixed;
            top: 0;
            left: 0;
            width: 40px;
            height: 40px;
            z-index: 10000;
            pointer-events: none;
            background-image: url('https://files.catbox.moe/u70y1m.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            /* HALO EFEKTƒ∞ */
            filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.8)) drop-shadow(0 0 5px rgba(255, 255, 255, 0.5));
            transition: transform 0.05s linear;
            /* Daha hƒ±zlƒ± tepki s√ºresi */
            transform: translate(-50%, -50%);
        }

        /* Tƒ±klama efekti */
        .clicking-cursor {
            transform: translate(-50%, -50%) scale(0.8) !important;
            filter: drop-shadow(0 0 10px #D90429) !important;
        }

        body.hovering #custom-cursor {
            transform: translate(-50%, -50%) scale(1.3);
            filter: drop-shadow(0 0 5px #D90429);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
            border: 1px solid #000;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #D90429;
        }

        /* --- STƒ∞LLER --- */
        body {
            background-color: #050505;
            color: #E8E8E8;
            background-image: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #000000 100%);
            overflow-x: hidden;
        }


        /* Kart Tasarƒ±mƒ± */
        .location-card {
            background: rgba(20, 20, 20, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .location-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 100%;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: skewX(-25deg);
            transition: 0.5s;
            z-index: 20;
            pointer-events: none;
        }

        .location-card:hover::before {
            left: 150%;
            transition: 0.7s;
        }

        .location-card:hover {
            border-color: #D90429;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(217, 4, 41, 0.15);
            background: rgba(30, 30, 30, 0.8);
        }

        .location-card img {
            filter: grayscale(100%) contrast(110%) brightness(80%);
            transition: all 0.5s ease;
        }

        .location-card:hover img {
            filter: grayscale(0%) contrast(100%) brightness(100%);
        }

        .card-highlighted {
            border: 1px solid #D90429 !important;
            box-shadow: 0 0 30px rgba(217, 4, 41, 0.4) !important;
            transform: scale(1.02);
            z-index: 50;
        }

        /* Harita */
        #map-diagram {
            height: 550px;
            width: 100%;
            background-color: #111;
            border: 1px solid rgba(255, 255, 255, 0.2);
            filter: grayscale(100%) contrast(110%) brightness(70%);
            transition: all 0.5s ease;
        }

        #map-diagram:hover {
            filter: grayscale(60%) contrast(100%) brightness(85%);
        }

        .marker-highlighted div {
            background-color: #D90429 !important;
            color: white !important;
            transform: scale(1.3);
            box-shadow: 0 0 20px #D90429 !important;
            border-color: #D90429 !important;
            transform: scale(1.3);
            box-shadow: 0 0 20px #D90429 !important;
            border-color: #D90429 !important;
            z-index: 999;
        }

        /* Back button hover */
        .back-btn:hover {
            border-color: #D90429 !important;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(217, 4, 41, 0.2);
        }

        /* Era badges */
        .era-badge {
            background: linear-gradient(145deg, rgba(217, 4, 41, 0.2), rgba(217, 4, 41, 0.1));
            border: 1px solid rgba(217, 4, 41, 0.3);
            color: #E8E8E8;
        }
    </style>

    <!-- Sound Effect -->
    <audio id="Sound" preload="auto">
        <source src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3" type="audio/mp3">
    </audio>

</head>

<body class="min-h-screen selection:bg-lipstick-red selection:text-white">

    <!-- √ñZEL ƒ∞MLE√á Dƒ∞V'ƒ∞ -->
    <div id="custom-cursor"></div>

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0  z-50 px-6 py-4">
        <div class="max-w-6xl mx-auto flex items-center justify-between">
            <a href="index.html"
                class="text-silver-plate hover:text-lipstick-red flex items-center gap-2 back-btn transition-all duration-300">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                Back to Archive
            </a>
            <h1 class="text-xl font-serif italic text-white">Queer London Archive</h1>
            <div></div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20 pb-12">
        <div class="max-w-4xl mx-auto px-6 space-y-12">

            <!-- Title Section -->
            <header class="text-center py-8 relative">
                <div
                    class="absolute top-0 left-1/2 -translate-x-1/2 w-px h-20 bg-gradient-to-b from-transparent via-lipstick-red to-transparent opacity-50">
                </div>
                <h1 id="location-title"
                    class="text-5xl md:text-6xl font-serif mb-4 text-transparent bg-clip-text bg-gradient-to-b from-white to-gray-500 drop-shadow-2xl">
                </h1>
                <p id="location-address" class="text-lg text-silver-plate font-light mb-6"></p>

                <!-- Badges -->
                <div class="flex flex-wrap justify-center mt-6 gap-3">
                    <span id="location-era"
                        class="era-badge px-4 py-2 rounded-full text-xs font-bold tracking-widest uppercase">
                    </span>
                </div>
            </header>

            <!-- Historical Context Section -->
            <section class="  ">
                <h2 class="text-3xl font-serif text-white mb-6 border-b border-lipstick-red pb-2 italic">Historical
                    Context</h2>

                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <img id="context-image-1" class="location-card rounded-sm w-full h-auto object-cover" src="" alt="">
                    </div>
                    <div class="space-y-4 text-silver-plate">
                        <p class="mb-4">This location represents an important part of London's queer history. During
                            this period, queer spaces often had to exist in hidden or temporary forms, creating networks
                            of community and resistance that shaped the city's social landscape.</p>

                        <p class="mb-4">The social and political climate of the time meant that queer individuals had to
                            be creative in finding spaces where they could express their identities and form
                            relationships. These locations, whether private homes, temporary gathering spots, or
                            commercial establishments, became vital sanctuaries.</p>
                    </div>
                </div>
            </section>

            <div class="section-break"></div>

            <!-- Significance Section -->
            <section class="  ">
                <h2 class="text-3xl font-serif text-white mb-6 border-b border-lipstick-red pb-2 italic">Significance
                </h2>

                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div class="order-2 md:order-1 space-y-4 text-silver-plate">
                        <p class="mb-4">Places like this served as vital sanctuaries for queer people to express their
                            identities, form relationships, and build communities in the face of social and legal
                            persecution. They represent both the resilience and the creativity of queer life throughout
                            history.</p>

                        <p class="mb-4">The significance of such spaces extends beyond their physical function. They
                            were sites of cultural production, political organizing, and the development of queer
                            identities and communities that would influence later generations.</p>

                        <p class="mb-4">Many of these locations were deliberately hidden or operated in gray areas of
                            the law, existing as "queer domesticity" - spaces where queer people could create temporary
                            homes and families outside of heteronormative expectations.</p>
                    </div>
                    <div class="order-1 md:order-2">
                        <img id="significance-image" class="location-card rounded-sm w-full h-auto object-cover" src="" alt="">
                    </div>
                </div>
            </section>

            <div class="section-break"></div>

            <!-- Legacy Section -->
            <section class="  ">
                <h2 class="text-3xl font-serif text-white mb-6 border-b border-lipstick-red pb-2 italic">Legacy</h2>

                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <img id="legacy-image" class="location-card rounded-sm w-full h-auto object-cover" src="" alt="">
                    </div>
                    <div class="space-y-4 text-silver-plate">
                        <p class="mb-4">The legacy of these queer spaces continues to influence contemporary LGBTQ+
                            communities. They remind us of the importance of creating safe spaces and the ongoing
                            struggle for visibility and acceptance.</p>

                        <p class="mb-4">Understanding these historical locations helps us appreciate the courage and
                            creativity of those who came before, while inspiring future generations to continue the work
                            of building inclusive communities.</p>

                        <p class="mb-4">These spaces, though many no longer exist in their original form, live on
                            through memory, archive, and the continued presence of queer communities in London's urban
                            landscape.</p>
                    </div>
                </div>
            </section>

            <div class="text-content">
                <p class="mb-4">The legacy of such spaces continues to influence contemporary queer culture and
                    community building in London. Understanding these historical locations helps us appreciate the
                    ongoing struggle for queer rights and recognition.</p>

                <p class="mb-4">Many of the strategies and community structures developed in these spaces - chosen
                    families, informal networks, and the creation of safe spaces - continue to be important elements of
                    queer community life today.</p>

                <p class="mb-4">While many of these physical locations have been lost to time, development, or changing
                    social landscapes, their memory lives on in archives, oral histories, and the continuing presence of
                    queer spaces throughout London.</p>
            </div>
            </section>

            <div class="section-break"></div>

            <!-- Map Section -->
            <section class="mb-12">
                <h2 class="text-3xl font-serif text-white mb-6 border-b border-lipstick-red pb-2 italic">Location</h2>
                <div id="map-diagram" class="rounded-lg">
                    <!-- Map will be injected here by JS -->
                </div>
            </section>

        </div>
        </div>
    </main>

    <!-- JavaScript Application Code -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. DATA & STATE ---

            // Color object for reliable JS access
            const ERA_COLORS = {
                'era-1700s': '#5E5B57',
                'era-early-20th': '#8A837D',
                'era-mid-century': '#B0A9A1',
                'era-late-20th': '#CFC9C1',
                'era-21st-century': '#E5E1DA',
            };

            let map;
            let locationData = {};

            // --- 2. INITIALIZATION ---

            // Parse URL parameters
            function getUrlParams() {
                const params = new URLSearchParams(window.location.search);

                // Helper function to safely decode parameters
                const decode = (str) => {
                    try {
                        return str ? decodeURIComponent(str) : '';
                    } catch (e) {
                        return str || '';
                    }
                };

                // Parse coordinates safely
                let coords = [51.50, -0.12]; // Default London coords
                const coordsStr = params.get('coords');
                if (coordsStr) {
                    const [lat, lng] = coordsStr.split(',').map(Number);
                    if (!isNaN(lat) && !isNaN(lng)) {
                        coords = [lat, lng];
                    }
                }

                return {
                    id: params.get('id') || '',
                    title: decode(params.get('title')),
                    era: decode(params.get('era')),
                    type: decode(params.get('type') || 'Temporary Social Gathering'),
                    address: decode(params.get('addr')),
                    description: decode(params.get('desc')),
                    imageUrl: decode(params.get('img')),
                    coords: coords
                };
            }

            // Initialize the page
            function initializePage() {
                locationData = getUrlParams();

                if (!locationData.id) {
                    document.body.innerHTML = `
                        <div class="min-h-screen flex items-center justify-center">
                            <div class="text-center">
                                <h1 class="text-2xl font-light text-red-600 mb-4">Location Not Found</h1>
                                <p class="text-gray-600 mb-6">No location data was provided.</p>
                                <a href="index.html" class="text-primary hover:text-secondary">Back to Map</a>
                            </div>
                        </div>
                    `;
                    return;
                }

                populateLocationDetails();
                initializeMap();
                loadImages();
            }

            // --- 3. CORE FUNCTIONS ---

            /**
             * Populate the page with location details
             */
            function populateLocationDetails() {
                // Set basic info
                document.getElementById('location-title').textContent = locationData.title || 'Unknown Location';
                document.getElementById('location-address').textContent = locationData.address || 'Address not available';

                // Set era badge
                const eraElement = document.getElementById('location-era');
                if (eraElement && locationData.era) {
                    eraElement.textContent = locationData.era;
                    // Map era to color key format
                    const eraKey = locationData.era.toLowerCase()
                        .replace(' ', '-')
                        .replace('early 20th', 'early-20th')
                        .replace('mid-century', 'mid-century')
                        .replace('late 20th', 'late-20th')
                        .replace('21st-century', '21st-century')
                        .replace('21st century', '21st-century');
                    const colorKey = `era-${eraKey}`;
                    const bgColor = ERA_COLORS[colorKey] || '#333';
                    eraElement.style.backgroundColor = bgColor;
                }
            }

            /**
             * Load images into the scattered layout
             */
            function loadImages() {
                const contextImage = document.getElementById('context-image-1');
                const significanceImage = document.getElementById('significance-image');
                const legacyImage = document.getElementById('legacy-image');

                // Use the provided image for context-image-1
                if (locationData.imageUrl) {
                    contextImage.src = locationData.imageUrl;
                    contextImage.alt = locationData.title || 'Historical Context';
                } else {
                    contextImage.src = `https://placehold.co/600x400/1a1a1a/ffffff?text=${encodeURIComponent('Historical Context')}`;
                    contextImage.alt = 'Historical Context';
                }

                // Use themed placeholders for other images
                if (significanceImage) {
                    significanceImage.src = `https://placehold.co/600x400/CFC9C1/5E5B57?text=${encodeURIComponent('Cultural Significance')}&font=inter`;
                    significanceImage.alt = 'Cultural Significance';
                }

                if (legacyImage) {
                    legacyImage.src = `https://placehold.co/600x400/B0A9A1/FFFFFF?text=${encodeURIComponent('Historical Legacy')}&font=inter`;
                    legacyImage.alt = 'Historical Legacy';
                }
            }

            /**
             * Initialize the map
             */
            function initializeMap() {
                if (locationData.coords.length !== 2) return;

                try {
                    // Initialize Leaflet Map
                    map = L.map('map-diagram').setView(locationData.coords, 16);

                    // Use a minimal, light-colored map from CartoDB
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                        maxZoom: 19,
                        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
                    }).addTo(map);

                    // Add marker for this location
                    const eraKey = locationData.era.toLowerCase()
                        .replace(' ', '-')
                        .replace('early 20th', 'early-20th')
                        .replace('mid-century', 'mid-century')
                        .replace('late 20th', 'late-20th')
                        .replace('21st-century', '21st-century')
                        .replace('21st century', '21st-century');
                    const colorKey = `era-${eraKey}`;
                    const bgColor = ERA_COLORS[colorKey] || '#333';
                    const iconColor = locationData.era && (locationData.era.includes('21st') || locationData.era.includes('Late')) ? '#2E2E2E' : 'white';

                    const iconMap = {
                        'Private/Domestic Residence': 'üè†',
                        'Temporary Social Gathering': '‚ö°Ô∏è',
                        'Commercial Club': 'üç∏',
                        'Shared & Co-operative Living': 'üç≤',
                        'Communal Squats & Social Centers': 'üè¢',
                        'Historical Association': 'üèõÔ∏è'
                    };

                    const customIcon = L.divIcon({
                        className: 'custom-div-icon',
                        html: `<div style="background-color: ${bgColor}; color: ${iconColor};" class="w-10 h-10 rounded-full flex items-center justify-center text-2xl shadow-md border-2 border-white opacity-90">${iconMap[locationData.type] || 'üìç'}</div>`,
                        iconSize: [40, 40],
                        iconAnchor: [20, 20]
                    });

                    L.marker(locationData.coords, { icon: customIcon }).addTo(map)
                        .bindPopup(locationData.title)
                        .openPopup();

                } catch (error) {
                    console.error("Map initialization failed:", error);
                    document.getElementById('map-diagram').innerHTML = `
                        <div class="h-full w-full flex items-center justify-center bg-red-100 text-red-700 p-4 rounded-lg">
                            <strong>Error:</strong> Failed to load the map.
                        </div>
                    `;
                }
            }

            // Initialize the page
            initializePage();
        });

        // --- WHIP ƒ∞MLE√á FONKSƒ∞YONLARI ---
        document.addEventListener('DOMContentLoaded', () => {
            const cursor = document.getElementById('custom-cursor');
            let mouseX = 0, mouseY = 0;
            let cursorX = 0, cursorY = 0;

            // Mouse pozisyonunu takip et
            document.addEventListener('mousemove', (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
            });

            // Smooth animasyon i√ßin
            function animateCursor() {
                const speed = 0.15; // Smoothness
                cursorX += (mouseX - cursorX) * speed;
                cursorY += (mouseY - cursorY) * speed;

                cursor.style.left = cursorX + 'px';
                cursor.style.top = cursorY + 'px';

                requestAnimationFrame(animateCursor);
            }
            animateCursor();

            // Tƒ±klama efekti
            document.addEventListener('mousedown', () => {
                cursor.style.transform = 'translate(-50%, -50%) scale(0.8)';
            });

            document.addEventListener('mouseup', () => {
                cursor.style.transform = 'translate(-50%, -50%) scale(1)';
            });

            // Link ve button hover efekti
            const interactiveElements = document.querySelectorAll('a, button, .location-card, .leaflet-interactive');
            interactiveElements.forEach(el => {
                el.addEventListener('mouseenter', () => {
                    cursor.style.transform = 'translate(-50%, -50%) scale(1.2)';
                });
                el.addEventListener('mouseleave', () => {
                    cursor.style.transform = 'translate(-50%, -50%) scale(1)';
                });
            });

            // --- TIKLAMA SESƒ∞ HAVUZU ---
            const audioPool = [];
            const poolSize = 5; // Aynƒ± anda √ßalƒ±nabilecek ses sayƒ±sƒ±
            let poolIndex = 0;

            // Ses havuzunu olu≈ütur
            for (let i = 0; i < poolSize; i++) {
                const audio = new Audio('https://files.catbox.moe/id40qe.mp3');
                audio.volume = 0.3;
                audio.preload = 'auto';
                audioPool.push(audio);
            }

            // Tƒ±klama sesi √ßal
            document.addEventListener('click', () => {
                const sound = audioPool[poolIndex];
                sound.currentTime = 0;
                sound.play().catch(e => console.log('Ses √ßalƒ±namadƒ±:', e));
                poolIndex = (poolIndex + 1) % poolSize;
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // sound effect
            const Sound = document.getElementById('Sound');

            // Play sound on any click
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.leaflet-container') &&
                    !e.target.closest('.leaflet-control-zoom') &&
                    !e.target.closest('a[href^="http"]')) {
                    Sound.currentTime = 0;
                    Sound.volume = 0.3; // Lower volume
                    Sound.play().catch(e => console.log('Sound play failed:', e));
                }
            });

            // Also play sound when hovering over interactive elements
            const interactiveElements = document.querySelectorAll('a, button, .location-card, .leaflet-interactive');
            interactiveElements.forEach(el => {
                el.addEventListener('mouseenter', () => {
                    Sound.currentTime = 0.5; // Start from middle of sound
                    Sound.volume = 0.2; // Even lower volume for hover
                    Sound.play().catch(e => { });
                });
            });
        });
    </script>

</body>

</html>
